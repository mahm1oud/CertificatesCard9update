# دليل إعداد قاعدة بيانات MySQL على هوستنجر

هذا الدليل يوضح كيفية إعداد قاعدة بيانات MySQL على استضافة هوستنجر لاستخدامها مع تطبيق CertificatesCard.

## الخطوة 1: الدخول إلى لوحة تحكم هوستنجر

1. قم بتسجيل الدخول إلى حساب هوستنجر الخاص بك
2. انتقل إلى "استضافة الويب" ثم اختر الاستضافة المطلوبة
3. انقر على "قواعد البيانات" في القائمة الجانبية

## الخطوة 2: إنشاء قاعدة بيانات MySQL جديدة

1. انقر على زر "إنشاء قاعدة بيانات جديدة"
2. أدخل اسمًا لقاعدة البيانات (مثال: `certificates_db`)
3. اختر إصدار MySQL المتاح (يفضل MySQL 5.7 أو أحدث)
4. انقر على "إنشاء"

## الخطوة 3: إنشاء مستخدم لقاعدة البيانات

1. ضمن قسم "مستخدمي قاعدة البيانات"، انقر على "إنشاء مستخدم جديد"
2. أدخل اسم المستخدم (مثال: `certs_user`)
3. أدخل كلمة مرور قوية أو استخدم مولد كلمات المرور
4. **هام**: احفظ اسم المستخدم وكلمة المرور في مكان آمن، ستحتاجهما لاحقًا
5. انقر على "إنشاء"

## الخطوة 4: ربط المستخدم بقاعدة البيانات

1. ضمن قسم "ربط المستخدمين"، اختر المستخدم الذي أنشأته من القائمة المنسدلة
2. اختر قاعدة البيانات التي أنشأتها من القائمة المنسدلة
3. امنح المستخدم جميع الصلاحيات (ALL PRIVILEGES) للتطوير والاختبار
   * في بيئة الإنتاج، يُنصح بمنح الصلاحيات اللازمة فقط: SELECT, INSERT, UPDATE, DELETE, CREATE, ALTER, INDEX, DROP
4. انقر على "ربط"

## الخطوة 5: الحصول على تفاصيل الاتصال

بعد إنشاء قاعدة البيانات والمستخدم، ستحتاج إلى معلومات الاتصال التالية:

1. **اسم المضيف**: عادةً ما يكون `localhost` في هوستنجر
2. **اسم المستخدم**: اسم المستخدم الذي أنشأته (مثال: `certs_user`)
3. **كلمة المرور**: كلمة المرور التي حددتها للمستخدم
4. **اسم قاعدة البيانات**: اسم قاعدة البيانات التي أنشأتها (مثال: `certificates_db`)
5. **المنفذ**: عادةً ما يكون `3306` (منفذ MySQL الافتراضي)

## الخطوة 6: تكوين ملف الإعدادات

1. قم بإنشاء ملف `hostinger.config.js` في المجلد الرئيسي لمشروعك باستخدام قالب `hostinger.config.example.js`
2. حدّث معلومات الاتصال بقاعدة البيانات:

```javascript
module.exports = {
  database: {
    host: "localhost",
    user: "certs_user",    // اسم المستخدم الخاص بك
    password: "your_password", // كلمة المرور الخاصة بك
    name: "certificates_db",   // اسم قاعدة البيانات الخاصة بك
    port: "3306"
  },
  // إعدادات أخرى...
};
```

## الخطوة 7: إعداد هيكل قاعدة البيانات

هناك طريقتان لإعداد هيكل قاعدة البيانات على هوستنجر:

### الطريقة الأولى: استيراد من ملف SQL

1. قم بتنزيل هيكل قاعدة البيانات من مشروعك المحلي أو استخدم ملف `certificates_database.sql` المضمّن في المشروع
2. في لوحة تحكم هوستنجر، انتقل إلى قسم "phpMyAdmin"
3. اختر قاعدة البيانات التي أنشأتها
4. انقر على تبويب "استيراد"
5. اختر ملف SQL واستورده

### الطريقة الثانية: استخدام سكريبت الإعداد

1. قم برفع المشروع بالكامل إلى هوستنجر
2. اتصل بالخادم عبر SSH (إذا كان متاحًا)
3. انتقل إلى مجلد المشروع
4. قم بتنفيذ:

```bash
node scripts/setup-mysql.js
```

أو استخدم السكريبت الشامل:

```bash
chmod +x install/scripts/hostinger-quick-setup.sh
./install/scripts/hostinger-quick-setup.sh
```

## الخطوة 8: التحقق من الإعداد

للتحقق من إعداد قاعدة البيانات بشكل صحيح:

1. اتصل بقاعدة البيانات باستخدام phpMyAdmin من لوحة تحكم هوستنجر
2. تأكد من وجود الجداول المطلوبة (users, templates, certificates, إلخ)
3. تحقق من وجود المستخدم الافتراضي (admin) الذي تم إنشاؤه بواسطة السكريبت

## استكشاف أخطاء قاعدة البيانات وإصلاحها

### مشكلة: خطأ في الاتصال بقاعدة البيانات

**الحل**:
- تحقق من صحة بيانات الاتصال في ملف `hostinger.config.js`
- تأكد من أن المستخدم له صلاحيات كافية للوصول إلى قاعدة البيانات
- تحقق من أن قاعدة البيانات تم إنشاؤها بشكل صحيح

### مشكلة: خطأ "Table does not exist"

**الحل**:
- تأكد من تنفيذ سكريبت إعداد قاعدة البيانات
- تحقق من وجود الجداول في phpMyAdmin
- قم بتنفيذ سكريبت الإعداد مرة أخرى إذا لزم الأمر

### مشكلة: خطأ في إدخال البيانات

**الحل**:
- تحقق من تطابق إصدار MySQL في هوستنجر مع إصدار التطويري
- تأكد من عدم وجود اختلافات في تعريفات الجداول
- تحقق من استخدام الترميز الصحيح لقاعدة البيانات (UTF-8 عادةً)

## نصائح إضافية

1. **الحفاظ على الأمان**: استخدم كلمات مرور قوية وامنح الحد الأدنى من الصلاحيات اللازمة فقط
2. **النسخ الاحتياطي**: قم بعمل نسخ احتياطية منتظمة لقاعدة البيانات
3. **التحقق من الأداء**: راقب أداء قاعدة البيانات واستخدم الفهارس (Indexes) لتحسين الأداء عند الحاجة
4. **التحديثات**: حافظ على تحديث إصدار MySQL للحصول على أحدث ميزات الأمان والأداء