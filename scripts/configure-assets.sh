#!/bin/bash

# ุณูุฑูุจุช ุฅุนุฏุงุฏ ุงูุฃุตูู ูุงูููุงุฑุฏ ุงููุดุชุฑูุฉ
# ูุฐุง ุงูุณูุฑูุจุช ูููู ุจุฅุนุฏุงุฏ ููุฒุงููุฉ ุงูููุงุฑุฏ ุงููุดุชุฑูุฉ ุจูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ูุงููุงุฌูุฉ ุงูุฎูููุฉ

# ุชุนููู ุงููุชุบูุฑุงุช
FRONTEND_DIR="./client"
BACKEND_DIR="./server"
FONTS_DIR="./fonts"
SHARED_DIR="./shared"
UPLOADS_DIR="./uploads"
TEMP_DIR="./temp"

# ุฅูุดุงุก ุงูุณุฌู
echo "๐ ุจุฏุก ุฅุนุฏุงุฏ ูุชููุฆุฉ ุงูููุงุฑุฏ ุงููุดุชุฑูุฉ..."

# ุงูุชุญูู ูู ูุฌูุฏ ุงููุฌูุฏุงุช ูุฅูุดุงุคูุง ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ
echo "๐ ุงูุชุญูู ูู ูุฌูุฏ ุงููุฌูุฏุงุช ุงูุฃุณุงุณูุฉ..."
for dir in "$FONTS_DIR" "$SHARED_DIR" "$UPLOADS_DIR" "$TEMP_DIR"; do
  if [ ! -d "$dir" ]; then
    echo "  ุฅูุดุงุก $dir..."
    mkdir -p "$dir"
  else
    echo "  $dir ููุฌูุฏ ุจุงููุนู."
  fi
done

# ูุณุฎ ุงูุฎุทูุท ุฅูู ูุฌูุฏ ุงูุฎุงุฏู
echo "๐ค ูุณุฎ ุงูุฎุทูุท ุฅูู ูุฌูุฏ ุงูุฎุงุฏู..."
if [ -d "$FONTS_DIR" ]; then
  # ุงูุชุฃูุฏ ูู ูุฌูุฏ ูุฌูุฏ ุงูุฎุทูุท ูู ุงูุฎุงุฏู
  mkdir -p "$BACKEND_DIR/fonts"
  
  # ูุณุฎ ูู ุงูุฎุทูุท
  echo "  ูุณุฎ ุงูุฎุทูุท ูู $FONTS_DIR ุฅูู $BACKEND_DIR/fonts"
  cp -r "$FONTS_DIR"/* "$BACKEND_DIR/fonts/" 2>/dev/null || true
  
  # ุงูุชุญูู ูู ูุฌุงุญ ุงููุณุฎ
  if [ $? -eq 0 ]; then
    echo "  โ ุชู ูุณุฎ ุงูุฎุทูุท ุจูุฌุงุญ."
  else
    echo "  โ๏ธ ูู ูุชู ุงูุนุซูุฑ ุนูู ูููุงุช ุฎุทูุท ูููุณุฎ."
  fi
else
  echo "  โ๏ธ ูุฌูุฏ ุงูุฎุทูุท ุบูุฑ ููุฌูุฏ."
fi

# ูุณุฎ ูููุงุช ุงูุฎุทูุท ุฅูู ูุฌูุฏุงุช ุงูููุงุฑุฏ ุงูุซุงุจุชุฉ ูููุงุฌูุฉ ุงูุฃูุงููุฉ
echo "๐ค ูุณุฎ ุงูุฎุทูุท ุฅูู ุงูููุงุฑุฏ ุงูุซุงุจุชุฉ ูููุงุฌูุฉ ุงูุฃูุงููุฉ..."
STATIC_FONTS_DIR="$FRONTEND_DIR/static/fonts"

# ุฅูุดุงุก ูุฌูุฏ ุงูุฎุทูุท ูู ุงูููุงุฑุฏ ุงูุซุงุจุชุฉ ุฅุฐุง ูู ููู ููุฌูุฏูุง
mkdir -p "$STATIC_FONTS_DIR"

# ูุณุฎ ุงูุฎุทูุท ุฅูู ูุฌูุฏ ุงูููุงุฑุฏ ุงูุซุงุจุชุฉ
if [ -d "$FONTS_DIR" ]; then
  echo "  ูุณุฎ ุงูุฎุทูุท ูู $FONTS_DIR ุฅูู $STATIC_FONTS_DIR"
  cp -r "$FONTS_DIR"/* "$STATIC_FONTS_DIR/" 2>/dev/null || true
  
  # ุงูุชุญูู ูู ูุฌุงุญ ุงููุณุฎ
  if [ $? -eq 0 ]; then
    echo "  โ ุชู ูุณุฎ ุงูุฎุทูุท ุฅูู ุงูููุงุฑุฏ ุงูุซุงุจุชุฉ ุจูุฌุงุญ."
  else
    echo "  โ๏ธ ูู ูุชู ุงูุนุซูุฑ ุนูู ูููุงุช ุฎุทูุท ูููุณุฎ."
  fi
fi

# ุงูุชุฃูุฏ ูู ูุฌูุฏ ููู CSS ููุฎุทูุท ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
FONTS_CSS="$FRONTEND_DIR/src/index.css"
if [ -f "$FONTS_CSS" ]; then
  echo "โ ููู CSS ููุฎุทูุท ููุฌูุฏ ุจุงููุนู."
else
  echo "โ๏ธ ููู CSS ููุฎุทูุท ุบูุฑ ููุฌูุฏ. ูุฑุฌู ุฅูุดุงุก ููู ูุชุนุฑูู ุงูุฎุทูุท."
fi

# ุงูุชุญูู ูู ูุฌูุฏ ุงูุชุญูููุงุช ูุฅูุดุงุก ุฑูุงุจุท ุฑูุฒูุฉ ุฅุฐุง ูุงู ุฐูู ูุทููุจูุง
echo "๐ ุฅุนุฏุงุฏ ูุฌูุฏ ุงูุชุญูููุงุช..."
if [ -d "$UPLOADS_DIR" ]; then
  # ุฅุฐุง ูุงู ุงููุดุฑูุน ูุนูู ูู ูุถุน ุงูุชุทููุฑ ูุชู ูุตู ุงูุฎุงุฏู ุนู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
  # ูููู ุฅูุดุงุก ุฑุงุจุท ุฑูุฒู ููุฌูุฏ ุงูุชุญูููุงุช ูู ุงููุฌูุฏ ุงูุซุงุจุช ูููุงุฌูุฉ ุงูุฃูุงููุฉ
  STATIC_UPLOADS_DIR="$FRONTEND_DIR/static/uploads"
  
  # ุฅูุดุงุก ูุฌูุฏ ูู ุงูููุงุฑุฏ ุงูุซุงุจุชุฉ ุฅุฐุง ูู ููู ููุฌูุฏูุง
  mkdir -p "$STATIC_UPLOADS_DIR"
  
  # ูุณุฎ ูููุงุช ุงูุชุญูููุงุช ุฅูู ุงูููุงุฑุฏ ุงูุซุงุจุชุฉ (ููุท ููุชุทููุฑ)
  if [ "$NODE_ENV" != "production" ]; then
    echo "  ูุณุฎ ูููุงุช ุงูุชุญูููุงุช ูู $UPLOADS_DIR ุฅูู $STATIC_UPLOADS_DIR (ูุถุน ุงูุชุทููุฑ)"
    cp -r "$UPLOADS_DIR"/* "$STATIC_UPLOADS_DIR/" 2>/dev/null || true
  fi
fi

# ุงูุชุญูู ูู ูุฌูุฏ ูููุงุช ุงููุฎุทุทุงุช ุงููุดุชุฑูุฉ
echo "๐ ุงูุชุญูู ูู ูููุงุช ุงููุฎุทุทุงุช ุงููุดุชุฑูุฉ..."
if [ -d "$SHARED_DIR" ]; then
  if [ -f "$SHARED_DIR/schema.ts" ]; then
    echo "  โ ููู ุงููุฎุทุท ุงูุฑุฆูุณู ููุฌูุฏ."
  else
    echo "  โ๏ธ ููู schema.ts ุบูุฑ ููุฌูุฏ ูู ูุฌูุฏ ุงููุดุงุฑูุฉ."
  fi
else
  echo "  โ๏ธ ูุฌูุฏ ุงููุดุงุฑูุฉ ุบูุฑ ููุฌูุฏ."
fi

echo "๐ ุชู ุงูุงูุชูุงุก ูู ุฅุนุฏุงุฏ ูุชููุฆุฉ ุงูููุงุฑุฏ ุงููุดุชุฑูุฉ ุจูุฌุงุญ!"