# دليل نشر التطبيق على منصة Render

## مقدمة

هذا الدليل يشرح كيفية نشر تطبيق منصة الشهادات والبطاقات الإلكترونية على منصة Render. يتكون التطبيق من:

1. واجهة خلفية (Backend API) مبنية بـ Node.js/Express
2. واجهة أمامية (Frontend) مبنية بـ React/Vite
3. قاعدة بيانات PostgreSQL

## متطلبات النشر

1. حساب على منصة [Render](https://render.com)
2. تهيئة المستودع Git للمشروع

## خطوات النشر

### 1. تحضير المشروع للنشر

تم تجهيز سكريبتات البناء اللازمة:
- `client/render-build.sh`: لبناء الواجهة الأمامية
- `server/render-build.sh`: لبناء الواجهة الخلفية
- `server/package.json.render`: لضمان تثبيت التبعيات الصحيحة للخادم

### 2. استخدام ملف التكوين `render.yaml`

يمكنك نشر التطبيق بسهولة باستخدام ملف التكوين `render.yaml` الذي يحدد جميع مكونات التطبيق والإعدادات المطلوبة.

1. قم بتسجيل الدخول إلى [لوحة تحكم Render](https://dashboard.render.com)
2. انقر على "New" ثم اختر "Blueprint"
3. حدد مستودع Git الخاص بالمشروع
4. سيتم استيراد ملف `render.yaml` تلقائيًا وإنشاء جميع الخدمات المطلوبة

### 3. المتغيرات البيئية الإضافية

ملف `render.yaml` يحتوي على المتغيرات الأساسية، ولكن قد تحتاج إلى إضافة متغيرات أخرى اعتمادًا على احتياجات التطبيق مثل:

- `SENDGRID_API_KEY`: إذا كنت تستخدم SendGrid لإرسال البريد الإلكتروني
- `FRONTEND_URL`: عنوان URL للواجهة الأمامية
- `OAUTH_*`: إذا كنت تستخدم المصادقة عبر مزودي خدمات خارجيين

### 4. تكوين قاعدة البيانات

ستقوم خدمة Render بإنشاء قاعدة بيانات PostgreSQL تلقائيًا. بعد الإنشاء:

1. سيتم إعداد متغير `DATABASE_URL` تلقائيًا
2. سيتم تشغيل سكريبت `npm run db:init` كعملية بعد النشر لتهيئة قاعدة البيانات

### 5. التحقق من النشر

بعد اكتمال عملية النشر:

1. تحقق من سجلات الخدمة في لوحة تحكم Render للتأكد من عدم وجود أخطاء
2. تأكد من أن الواجهة الخلفية تعمل بشكل صحيح بزيارة نقطة فحص الصحة `/health/ping`
3. زر الواجهة الأمامية وتأكد من اتصالها بالواجهة الخلفية بنجاح

## استكشاف الأخطاء وإصلاحها

إذا واجهت مشاكل أثناء النشر:

1. تحقق من سجلات البناء والتشغيل في لوحة تحكم Render
2. تأكد من تثبيت جميع التبعيات المطلوبة في ملفات `package.json`
3. تأكد من صحة إعدادات متغيرات البيئة

## النشر اليدوي (بدون Blueprint)

إذا كنت ترغب في نشر كل خدمة يدويًا بدلاً من استخدام ملف Blueprint:

1. أنشئ قاعدة بيانات PostgreSQL جديدة في Render
2. أنشئ خدمة ويب للواجهة الخلفية باستخدام الإعدادات المذكورة في `render.yaml`
3. أنشئ خدمة ستاتيكية للواجهة الأمامية باستخدام الإعدادات المذكورة في `render.yaml`
4. تأكد من إعداد جميع متغيرات البيئة المطلوبة يدويًا

## الملاحظات النهائية

- تأكد من تغيير كلمة مرور المستخدم الافتراضي `admin` بعد النشر الأول
- قم بتكوين خدمة البريد الإلكتروني إذا كنت تستخدم ميزات استعادة كلمة المرور
- قم بتنفيذ النسخ الاحتياطي المنتظم لقاعدة البيانات

---

إذا واجهت أي مشاكل أو كان لديك أسئلة حول عملية النشر، يرجى التواصل مع فريق الدعم.